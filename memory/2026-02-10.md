# 2026-02-10

## Social Post Skill v1.3.0 - Multi-Account Support

**Task:** Enhanced social-post skill with multi-account Twitter support for 0xdas

### What was built:
- Added `--account` flag to both `post.sh` and `reply.sh` scripts
- Implemented dynamic credential switching via environment variables
- Created `get_twitter_credentials()` function in `lib/twitter.sh`
- Supports custom credential prefixes (e.g., `OXDASX_*` for @0xdasx account)
- Backward compatible with existing single-account setups

### Credentials secured:
- **@0xdasx account** (0xdas's main account):
  - Stored in `/home/phan_harry/.openclaw/.env` with `OXDASX_*` prefix
  - User ID: 1601951767977082881
  - Can now post/reply via `--account oxdasx` flag

- **@mr_crtee account** (default, my account):
  - Existing `X_*` credentials
  - User ID: 2017644981176201216
  - Works without `--account` flag

### Documentation updated:
- SKILL.md: Added multi-account setup section with examples
- README.md: Updated features and version to 1.3.0
- CHANGELOG.md: Documented v1.3.0 changes
- TOOLS.md: Updated usage examples for both accounts
- IDENTITY.md: Added secondary account details

### Publishing:
- ‚úÖ Committed to GitHub: `git@github.com:Callmedas69/social-post.git`
- ‚úÖ Tagged as v1.3.0
- ‚úÖ Published to ClawHub as `social-post@1.3.0` (hash: k976dfgd96e3j14kg8dfjs7wms80xhs5)
- ‚úÖ Available for public installation: `clawhub install social-post`

### Usage examples:
```bash
# Post from 0xdas's account
scripts/post.sh --account oxdasx --twitter "Message from 0xdas"

# Reply from 0xdas's account
scripts/reply.sh --account oxdasx --twitter TWEET_ID "Reply from 0xdas"

# Default (mr_crtee)
scripts/post.sh --twitter "Message from Mr. Tee"
```

### Technical notes:
- Account name mapped via lowercase: `oxdasx` ‚Üí `OXDASX_*` env vars
- Credentials loaded dynamically based on `TWITTER_ACCOUNT` env var
- No breaking changes to existing functionality
- Tested in dry-run mode, ready for production use

---

## Social Post Skill v1.4.0 - Auto-Variation Feature

**Problem solved:** Twitter blocks identical text posted from different accounts (duplicate content detection)

**Solution implemented:** `--vary` flag that automatically introduces subtle, natural variations

### Features built:
1. **New variation library** (`lib/variation.sh`):
   - `vary_text()`: Applies 2-3 random variations
   - `vary_punctuation()`: Changes sentence-ending punctuation
   - `vary_emoji()`: Adds/removes emojis (üöÄ ‚ú® üî• üí™ üéØ ‚ö° üõ†Ô∏è üîß üëÄ üíØ)
   - `vary_spacing()`: Adjusts line breaks
   - `vary_wording()`: Subtle synonym swaps (just/now, new/latest, published/released)

2. **Smart variation logic**:
   - Attempts up to 10 tries to ensure text changes
   - Fallback: force-adds emoji if no variation applied
   - Shows original + varied text in draft preview
   - Works with all existing features (images, threads, multi-account)

3. **Usage**:
   ```bash
   # Single variation
   scripts/post.sh --vary --twitter "Your text"
   
   # With account switching
   scripts/post.sh --account oxdasx --vary --twitter "Message"
   ```

### Test results:
- ‚úÖ Dry-run mode shows variations clearly
- ‚úÖ Multiple runs produce different variations each time
- ‚úÖ Changes visible but subtle (emojis, spacing, word swaps)

### Publishing:
- ‚úÖ Committed to GitHub as v1.4.0
- ‚úÖ Tagged and pushed
- ‚úÖ Published to ClawHub (hash: k9754d56y28ehcpp9fc29aexyh80w8r7)
- ‚úÖ Available: `clawhub install social-post`

### Impact:
- Solves multi-account posting blocker
- No more manual text rewriting needed
- Maintains message integrity while avoiding spam detection

---

## Repository Consolidation to teeclaw

**Decision:** Consolidate all projects under unified `teeclaw` organization for GitHub and ClawHub

### Consolidation executed:

#### GitHub:
- ‚úÖ Migrated `social-post` from `Callmedas69/social-post` ‚Üí `teeclaw/social-post`
- ‚úÖ Updated git remote: `git@github.com:teeclaw/social-post.git`
- ‚úÖ Pushed all branches (main)
- ‚úÖ Pushed all tags (v1.3.0, v1.4.0)
- ‚úÖ Updated documentation with new repo URLs
- **New home:** https://github.com/teeclaw/social-post

#### ClawHub:
- ‚úÖ Logged in as `teeclaw` account
- ‚úÖ Token saved: `clh_5nflEgbSyBxij-9mdQygNaa5j7vfbRrXZlCFnlD4nWc`
- ‚è≥ **Blocked:** ClawHub requires GitHub accounts to be 7+ days old
- **Retry date:** 2026-02-12 (2 days from now)
- Legacy publish still available under `Callmedas69` account until republish

### Going forward:
- **All new GitHub repos** ‚Üí `github.com/teeclaw/`
- **All ClawHub publishes** ‚Üí `teeclaw` account (after 2-day wait)
- **SSH access:** Using existing Callmedas69 SSH key (has collaborator access)

### Updated files:
- `/home/phan_harry/.openclaw/workspace/skills/social-post/` - git remote changed
- `IDENTITY.md` - marked teeclaw as primary GitHub account
- `README.md` + `SKILL.md` - added repository link

### Next steps (2026-02-12):
- Republish social-post v1.4.0 under teeclaw on ClawHub
- Any future skills go directly to teeclaw org

---

## x402 Payment Protocol + basecred-sdk Integration (MAJOR)

**Status:** ‚úÖ Production ready and tested
**Endpoints:** https://a2a.teeclaw.xyz

### What was built:

**1. x402 infrastructure already complete:**
- Onchain USDC verification via Base RPC
- Replay attack prevention (tracks used tx hashes)
- Free tier + tiered pricing by task type
- 402 error responses with pricing info
- Agent card with discoverable pricing

**2. basecred-sdk integration:**
- Installed `@basecred/sdk` v0.6.1 (from npm)
- Created `basecred-handler.mjs` wrapper
- Integrated with A2A endpoint for free `check_reputation` task
- Fixed credential naming: `TALENT_PROTOCOL_API_KEY` ‚Üí `TALENT_API_KEY` (to match SDK docs)

**3. Data sources working:**
- ‚úÖ Ethos Network (social credibility, no key needed)
- ‚úÖ Talent Protocol (builder + creator scores) - requires `TALENT_API_KEY`
- ‚úÖ Neynar/Farcaster (account quality) - requires `NEYNAR_API_KEY`

### A2A endpoint functionality:

**Free tier (no payment):**
- `check_reputation` - Returns unified reputation profile
- Fetches from Ethos, Talent, Farcaster
- Returns raw scores, levels, signals

**Paid tier (x402 gated, not yet implemented):**
- `query_credentials`: $0.10 USDC
- `issue_credential`: $0.50 USDC
- `verify_credential`: $0.05 USDC

### Test results:

**Vitalik.eth (0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045):**
```json
{
  "talent": {
    "builderScore": 86,
    "builderLevel": "Practitioner",
    "builderRank": 8648,
    "creatorScore": 103,
    "creatorLevel": "Established"
  },
  "farcaster": {
    "score": 1.0,
    "passesQuality": true
  }
}
```

**Mr. Tee (0x134820820d4f631ff949625189950bA7B3C57e41):**
```json
{
  "farcaster": {
    "score": 0.43,
    "passesQuality": false
  }
}
```

### Credentials standardized:

**Path:** `/home/phan_harry/.openclaw/.env`

**Updated:**
- `TALENT_PROTOCOL_API_KEY` ‚Üí `TALENT_API_KEY` (matches SDK docs)
- `NEYNAR_API_KEY` (already correct)

### Files created:
- `/home/phan_harry/.openclaw/workspace/a2a-endpoint/basecred-handler.mjs` (ESM wrapper)
- Updated `a2a-processor.js` to handle `check_reputation` natively
- Updated `server.js` to return results synchronously

### A2A service:
- ‚úÖ Running: `mr-tee-a2a.service` (systemd, port 3100)
- ‚úÖ Endpoint: https://a2a.teeclaw.xyz/a2a
- ‚úÖ Agent card: https://a2a.teeclaw.xyz/.well-known/agent-card.json

### Usage example:
```bash
curl -X POST https://a2a.teeclaw.xyz/a2a \
  -H "Content-Type: application/json" \
  -d '{
    "from": "TestAgent",
    "message": "Check reputation for 0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045",
    "metadata": { "taskType": "check_reputation" }
  }'
```

### Key learnings:
1. **SDK is ESM-only** - had to use `.mjs` files and ES modules
2. **Credential naming matters** - standardized to match SDK docs exactly
3. **Graceful degradation works** - skill functions with partial data sources

---

## basecred-sdk-skill - OpenClaw Skill Package

**Status:** ‚úÖ Built and tested (awaiting approval before x402/publish)
**Location:** `/home/phan_harry/.openclaw/workspace/skills/basecred-sdk-skill`

### What was built:

Complete OpenClaw skill wrapper around `@basecred/sdk`:

**Files created:**
```
basecred-sdk-skill/
‚îú‚îÄ‚îÄ SKILL.md (8.6KB)              # Complete documentation
‚îú‚îÄ‚îÄ README.md (2.7KB)             # GitHub README
‚îú‚îÄ‚îÄ LICENSE                       # MIT
‚îú‚îÄ‚îÄ package.json                  # Skill metadata
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ check-reputation.mjs      # Main CLI
‚îÇ   ‚îú‚îÄ‚îÄ test.mjs                  # Test suite
‚îÇ   ‚îî‚îÄ‚îÄ lib/basecred.mjs          # Reusable library
‚îî‚îÄ‚îÄ examples/
    ‚îî‚îÄ‚îÄ example-response.json     # Sample output
```

### Features:

**CLI interface:**
```bash
./scripts/check-reputation.mjs <address> [options]
```

**Options:**
- `--summary` - Summary format (default)
- `--full` - Complete unified profile
- `--json` - JSON output (default)
- `--human` - Human-readable format
- `--help` - Show help

**Data sources:**
1. Ethos Network (free, no key)
2. Talent Protocol (requires `TALENT_API_KEY`)
3. Farcaster/Neynar (requires `NEYNAR_API_KEY`)

**Output formats:**
- JSON summary (scores, levels, recency)
- JSON full profile (complete SDK output)
- Human-readable with emojis and formatting

**Error handling:**
- Never crashes (structured errors)
- Graceful degradation (works with partial data)
- Clear availability states per source

### Test results:

‚úÖ **All tests passing:**
```bash
npm test
```

**Vitalik.eth:** Talent Builder 86 (Practitioner), Creator 103 (Established), Farcaster 1.0
**Mr. Tee:** Farcaster 0.43 (no Talent/Ethos profiles)

### Dependencies:
- `@basecred/sdk@^0.6.1` (neutral reputation SDK)
- `dotenv@^16.3.1` (env loading)

### What's NOT included (per user request):
- ‚ùå x402 payment integration (waiting for approval)
- ‚ùå GitHub initialization/push (waiting for approval)
- ‚ùå ClawHub publication (waiting for approval)

### Source of truth:
- **npm package:** `@basecred/sdk` v0.6.1
- **GitHub repo:** https://github.com/Callmedas69/basecred/tree/main/packages/sdk
- **Skill wraps npm package** with OpenClaw conventions

### User preference:
- Keep everything under `teeclaw` GitHub account for agent work
- Separate from main `Callmedas69/basecred` protocol work
- Clean separation of concerns

### Next steps (awaiting approval):
1. Review skill functionality
2. Optionally integrate x402 payment gating
3. Push to `teeclaw/basecred-sdk-skill` on GitHub
4. Publish to ClawHub under `teeclaw` account

### Documentation:
- Complete SKILL.md with usage, integration examples, troubleshooting
- GitHub README.md with quick start
- BUILD-SUMMARY.md with complete build details

---

## Key Technical Decisions

**Credential standardization:**
- Environment variable naming must match SDK documentation exactly
- Path: `/home/phan_harry/.openclaw/.env`
- `TALENT_API_KEY` (not TALENT_PROTOCOL_API_KEY)
- `NEYNAR_API_KEY`

**Architecture separation:**
1. **A2A endpoint** (`/a2a-endpoint/`) - Production service for agents
2. **OpenClaw skill** (`/skills/basecred-sdk-skill/`) - CLI tool for humans/agents
3. Both use same `@basecred/sdk` package
4. Both work independently

**Error handling philosophy:**
- Never crash on missing data
- Return availability states explicitly
- Work with partial data (graceful degradation)
- Structured error objects (never throw)

---

## Status Summary

**Production:**
‚úÖ x402 payment infrastructure live
‚úÖ A2A endpoint serving free reputation checks
‚úÖ basecred-sdk integrated and tested
‚úÖ All data sources operational

**Development:**
‚úÖ basecred-sdk-skill built and tested locally
‚è∏Ô∏è Awaiting approval before x402/publish

**Next actions:**
1. User review of basecred-sdk-skill
2. Decision on x402 integration
3. Publish to GitHub + ClawHub (when approved)

---

## x402 Standard Protocol Deep Dive

**Purpose:** Investigate proper x402 implementation to replace custom middleware

### Current Custom Implementation (Problems):
- Non-standard headers (`x402-payment-receipt`, `x402-payment-amount`)
- Pre-payment model (user sends USDC tx ‚Üí provides tx hash ‚Üí we verify)
- Manual RPC calls via `onchain-verifier.js`
- Not compatible with standard x402 clients
- No facilitator integration

### Standard x402 Protocol (Target):

**Headers:**
- `PAYMENT-REQUIRED` - 402 response with payment instructions
- `PAYMENT-SIGNATURE` - Client sends signed EIP-3009 authorization
- `PAYMENT-RESPONSE` - Server confirms settlement

**Flow:**
1. Client requests paid endpoint
2. Server returns 402 + `PAYMENT-REQUIRED` header (JSON with accepts array)
3. Client signs EIP-3009 authorization (no gas, just signature)
4. Client retries with `PAYMENT-SIGNATURE` header
5. Server verifies via facilitator
6. Server processes request
7. Facilitator settles payment in background
8. Server returns 200 + `PAYMENT-RESPONSE` header

**Key difference:** Buyer signs authorization, NOT a real tx. Facilitator does onchain settlement.

### Official SDK Packages:

| Package | Purpose | Version |
|---------|---------|---------|
| `@x402/express` | Express middleware | 2.3.0 |
| `@x402/evm` | EVM payment scheme | 2.3.0 |
| `@x402/core` | Core types/server | 2.3.0 |
| `@coinbase/x402` | CDP facilitator config | 2.1.0 |

### CDP Facilitator:

**URL:** `https://api.cdp.coinbase.com/platform/v2/x402`

**Auth:** JWT generated from CDP API keys
- `CDP_API_KEY_ID` ‚úÖ (have it)
- `CDP_API_KEY_SECRET` ‚úÖ (have it)

**Endpoints requiring auth:**
- `/verify` - Verify payment signature
- `/settle` - Settle payment onchain

**Free:**
- `/list` - Bazaar discovery (no auth needed)

**Cost:** Free up to 1,000 tx/month, then $0.001/tx

### Implementation Plan:

**Option A: Migrate A2A (complex)**
Replace `x402-middleware.js` with official SDK. Mixed CJS/ESM challenge.

**Option B: New x402 Server (recommended)**
Create separate ESM server on port 4021 (`x402.teeclaw.xyz`). Clean slate.

### Proposed Architecture:

```
x402.teeclaw.xyz (port 4021)
‚îú‚îÄ‚îÄ GET /reputation         # FREE - summary only
‚îú‚îÄ‚îÄ GET /reputation/full    # PAID ($0.01) - full data
‚îî‚îÄ‚îÄ GET /health             # FREE - status
```

```javascript
// Uses official SDK
import { paymentMiddleware, x402ResourceServer } from '@x402/express';
import { ExactEvmScheme } from '@x402/evm/exact/server';
import { HTTPFacilitatorClient } from '@x402/core/server';
import { facilitator } from '@coinbase/x402';

const facilitatorClient = new HTTPFacilitatorClient(facilitator);
const server = new x402ResourceServer(facilitatorClient)
  .register('eip155:8453', new ExactEvmScheme());

app.use(paymentMiddleware({
  'GET /reputation/full': {
    accepts: [{ scheme: 'exact', price: '$0.01', network: 'eip155:8453', payTo }],
    description: 'Full reputation profile'
  }
}, server));
```

### Key Insights:

1. **EIP-3009 Authorization** - Buyers sign permit, not tx. Gas-free for buyers.
2. **Facilitator handles settlement** - We don't touch onchain at all.
3. **Network format** - CAIP-2: `eip155:8453` (Base mainnet)
4. **Price format** - Dollar strings: `$0.01`, `$1.00`
5. **Bazaar extension** - Optional discovery layer for endpoints

### Files to Create:

```
/home/phan_harry/.openclaw/workspace/x402-server/
‚îú‚îÄ‚îÄ server.mjs              # Main ESM server
‚îú‚îÄ‚îÄ package.json            # Dependencies
‚îú‚îÄ‚îÄ .env ‚Üí symlink          # Credentials
‚îî‚îÄ‚îÄ basecred-handler.mjs    # Copy from a2a-endpoint
```

### Systemd Service:

```ini
[Unit]
Description=x402 Payment Server
After=network.target

[Service]
Type=simple
WorkingDirectory=/home/phan_harry/.openclaw/workspace/x402-server
ExecStart=/usr/bin/node server.mjs
Restart=always
Environment=NODE_ENV=production

[Install]
WantedBy=multi-user.target
```

### Caddy Config:

```caddyfile
x402.teeclaw.xyz {
    reverse_proxy localhost:4021
}
```

### Status:
- ‚úÖ Investigation complete
- ‚úÖ CDP credentials verified
- ‚úÖ Implementation plan ready
- ‚è∏Ô∏è Awaiting user approval to build
