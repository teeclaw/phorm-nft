# Memory — 2026-02-18

## CRITICAL: Wallet Compromised + Recovery

### What Happened
- Wallet `0x134820820d4f631ff949625189950bA7B3C57e41` (teeclaw.eth) was drained at ~03:45 UTC
- Attack vector: `OPENCLAW_GPG_PASSPHRASE` was stored in plaintext in `~/.openclaw/.env`
- Attacker read `.env` + `.env.secrets.gpg` (was world-readable rw-r--r--) → decrypted AGENT_WALLET_PRIVATE_KEY
- ETH and USDC drained. EIP-7702 delegation set to `0xDdE8ac2d2D69B7e52419ea1503B6CE8d5e699aDD` (malicious contract) as persistent backdoor
- EIP-7702 delegation revoked via relay pattern (legacy Farcaster wallet paid gas, nonce 120) — tx: 0x2adc225982b7afcdd51a91c301c9dab778a9d8e817ccc26f1acaa1a548d639c5
- Attacker continued draining directly (nonce 121 — type 0 Legacy tx) — confirmed raw key still in attacker's hands

### Phase 2 Completed — New Wallet
- **New wallet address:** `0x112F14D7aB03111Fdf720c6Ccc720A21576F7487`
- **Old wallet (RETIRED):** `0x134820820d4f631ff949625189950bA7B3C57e41` ⚠️ DO NOT USE
- New private key encrypted in `~/.openclaw/.env.secrets.gpg` (mode 600)
- New GPG passphrase: NOT in `.env` — stored in `~/.openclaw/.gpg-passphrase` (mode 400, owner read-only)
- `.env` now has `OPENCLAW_GPG_PASSPHRASE=$(cat ~/.openclaw/.gpg-passphrase 2>/dev/null)` — dynamic load

### Security Fixes Applied
- `~/.openclaw/.env.secrets.gpg` → chmod 600 (was 644)
- `~/.openclaw/.gpg-passphrase` → mode 400, separate from .env
- `OPENCLAW_GPG_PASSPHRASE` removed from plaintext in `.env`
- Existing scripts using `source ~/.env` continue to work (env var still set, just sourced from file)

### Phase 3/4 Progress

**Completed:**
- [x] x402 server wallet updated to 0x112F...7487
- [x] A2A endpoint server.js updated + restarted (pm2)
- [x] Live agent card (.well-known/agent-card.json) now shows new wallet
- [x] All workspace files bulk-updated (a2a-endpoint, x402, scripts, specs)
- [x] Bankr API key confirmed DEAD (401) — rotate at bankr.bot/api

**Pending - needs user action:**
- [ ] Rotate Bankr API key (bankr.bot/api — current key is dead/revoked)
- [ ] Rotate ONCHAIN_API_KEY (onchain.fi)
- [ ] Rotate CDP_API_KEY_ID/SECRET (portal.cdp.coinbase.com)
- [ ] Rotate CLAUDE_CODE_OAUTH_TOKEN (console.anthropic.com)
- [ ] Rotate X/Twitter API keys (developer.twitter.com — both accounts)
- [ ] Rotate NEYNAR_API_KEY (dev.neynar.com)
- [ ] Rotate CLAWHUB_TOKEN (clawhub.com)
- [ ] Rotate MOLTBOOK/MOLTEN/FOURCLAW/BRAVE/OPENROUTER keys
- [ ] Farcaster FID 2700953 custody transfer — requires old wallet at warpcast.com/~/settings
- [x] ERC-8004 #14482 — deactivated (active:false) + sent to dead address 0x000...dEaD (2026-02-18 09:09 UTC)
- [ ] ENS teeclaw.eth transfer to new wallet

### Key Script Files Created
- `scripts/gen-wallet.js` — generates new keypair (stdout only, never to disk)
- `scripts/rotate-secrets.sh` — re-encrypt secrets with new key + passphrase
- `scripts/revoke-eip7702-relay.js` — relay pattern for EIP-7702 revocation (keep for reference)
