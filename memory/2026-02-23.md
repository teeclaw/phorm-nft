# 2026-02-23

## Session 1 (00:30 UTC)

**CryptoClarity Manifesto v3: Open Signing with Two-Tier System**

Major redesign of CryptoClarity signing system. Previously gated to ERC-8004 agents only, now open to all AI agents.

### Design Decisions
- **Two-tier system:** ERC-8004 registered agents sign free (verified badge), everyone else pays $1 USDC
- **$1 USDC fee** as spam filter, transferred directly to Safe wallet (never held by resolver)
- **Irrevocable signatures** (onRevoke returns false)
- **Configurable registry array** (can add new ERC-8004 registries without redeploying)
- **Direct USDC onchain** (not x402, since resolver executes inside EAS transaction, no HTTP layer)

### CryptoClarityResolver v3 Contract
- **Address:** `0x484a999810F659f6928FcC59340530462106956B` (Base mainnet)
- **Deploy Tx:** `0xbb283460e5081c45bf50e1bbd90cbd412056868b633f3c244f8783fe9dad9fa7`
- **Owner:** `0x168D8b4f50BB3aA67D05a6937B643004257118ED` (cold wallet, Ownable2Step)
- **Treasury:** `0xFdF53De20f46bAE2Fa6414e6F25EF1654E68Acd0` (Safe on Base)
- **USDC:** `0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913`
- **Trusted Registries:**
  1. Main: `0x8004A169FB4a3325136EB29fA0ceB6D2e539a432`
  2. zScore: `0xFfE9395fa761e52DBC077a2e7Fd84f77e8abCc41`
- **Signing Fee:** 1,000,000 (=$1 USDC, 6 decimals)
- **MAX_FEE:** $100 USDC cap
- **MAX_REGISTRIES:** 20

**Security (Cyfrin solskill compliant):**
- Ownable2Step (two-step ownership transfer)
- ReentrancyGuardTransient (Cancun transient storage)
- Pausable (emergency stop)
- CEI pattern
- Custom errors with `CryptoClarityResolver__` prefix
- Strict pragma 0.8.26
- Optimizer enabled (200 runs)
- @custom:security-contact natspec
- Fuzz tests (512 runs)

**Verification:**
- Sourcify: ✅ Exact match (verification ID: 4e02a3b5-3049-41a2-a601-285aa3aa1e65)
- Routescan: ✅ Submitted

### New EAS Schema (v3)
- **Schema UID:** `0x79a16f5428f2ff113869491fc9c90e0109b0150e2d4b89f47e3e21aeccbc26dc`
- **Registration Tx:** `0xc50a444ca5128c9dcf80de1908b7f515ec0ad20962e45240fa1e6101c081d077`
- **Block:** 42510490
- **Fields:** `string manifestoVersion, bytes32 manifestoHash, string agentName, string agentDescription, address registryAddress, uint256 registryAgentId`
- **Resolver:** `0x484a999810F659f6928FcC59340530462106956B`
- **Revocable:** false

### cryptoclarity.wtf Updates
- Updated schema UID to new v3 schema
- Added verified badge (green "✓ verified" for ERC-8004 agents)
- Added unverified badge (gray "signed" for paid signers)
- Added agent description display
- Shows attester address instead of separate agentWallet field
- Deployed: 2026-02-23 01:35 UTC
- Backup: `/var/www/cryptoclarity.wtf.backup/20260223_013504`

### Previous Contracts (for reference)
- **Old Resolver:** `0x3F09eD14662606A050afc043D5b2877aC939635e` (v1, ERC-8004 only)
- **Old Schema UID:** `0xe8913f508ec06446fedef5da1a5f85310bd0dc93a02f36c020628889aac172f7`
- **Old Attestation (Mr. Tee v2.0):** `0x2701e9a36c43b7d5484ae697b4f3f7241f2bb72557d6e348a2746d9710ab505a`

### Mr. Tee v3 Attestation
- **Attestation UID:** `0x3a6b92f2e82c3ce21685599d0a78c68c84fc7f989e32f078a331a3711c081b64`
- **Tx:** `0xf6efb249089bbe27605180402dbd358b0fde030796ca807ee5583c605feacf27`
- **Block:** 42510776
- **Verified:** true (ERC-8004 agent, $0 fee)

### BaseScan API Key
- Stored in GCP Secret Manager as `BASESCAN_API_KEY`
- Value: `8XY3VCV83PXZEHRXD8D9U2K1PHFC44S5QQ`

### Vercel Migration
- CryptoClarity migrated from self-hosted Caddy to Vercel
- Repo: https://github.com/teeclaw/cryptoclarity (auto-deploy on push to main)
- Local deploy dir: `/tmp/cryptoclarity-vercel` (cloned repo for pushing)
- Caddy block for cryptoclarity.wtf removed from server
- `vercel.json` has all security headers (HSTS, CSP, Permissions-Policy, etc.)
- Domain: `cryptoclarity.wtf` (apex primary, www redirects to apex)

### Security Hardening
- HSTS: `max-age=63072000; includeSubDomains; preload`
- CSP moved from HTML meta tag to HTTP header (Caddy, then Vercel)
- X-Frame-Options: DENY
- Permissions-Policy: camera, mic, geo, FLoC blocked
- Referrer-Policy: no-referrer
- HTML no-cache, PNG 1-hour cache
- Removed deprecated X-XSS-Protection
- Removed meta CSP from HTML (single source of truth in server headers)

### UI/UX Overhaul
- Moved "Get your agent to sign" CTA from right column to left column (section 06)
- Hero button and mobile floating CTA point to #sign-action
- Pricing tiers separated from onboard box with breathing room
- Smart counter: smaller font + "be next" when ≤10 signers
- List header: "Onchain ID" → "Date"
- Badge text: "verified" → "ERC-8004"
- Added "Share this" link for non-agent visitors
- Focus ring on copy block
- skill.md completely rewritten for v3 two-tier system

### Public Goods Statement
- Landing page: "Every dollar collected funds public goods for the agent ecosystem" with link to Safe on BaseScan
- skill.md: "100% of signing fees fund public goods" with treasury address
- $1 USDC signing fees → public goods treasury (Safe: 0xFdF53De20f46bAE2Fa6414e6F25EF1654E68Acd0)
- $CLARITY token is SEPARATE from signing fees (not connected)

### $CLARITY Token
- **Name:** CLARITY
- **CA:** `0x826a322b75B1b5b65B336337BCCAE18223beBb07` (Base)
- **Description:** "The anti-rug token that funds agent transparency"
- Added as Section 07 on landing page with BaseScan link
- Added to footer
- NOT connected to signing fees (those go to public goods treasury)

### Cyfrin solskill Review
- Applied Cyfrin/solskill standards to CryptoClarityResolver
- Strict pragma 0.8.26, `ContractName__ErrorName` pattern, section headers
- ReentrancyGuardTransient (Cancun), fuzz tests (512 runs), branching tree
- Optimizer enabled (200 runs), SCREAMING_SNAKE_CASE immutables
- @custom:security-contact natspec

- User preference: this Telegram channel is dedicated only for social media posting tasks.
